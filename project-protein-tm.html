<!doctype html>
<html lang="en" data-theme="light">
<head>
  <meta charset="utf-8">
  <title>Protein Tm Prediction ‚Äî Shubo Li</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Protein melting temperature prediction via ESM and AlphaFold with biophysical features">
  <link rel="stylesheet" href="assets/style.css">
  <script defer src="assets/site.js"></script>
</head>
<body>
<header class="site-header">
  <nav class="nav">
    <a class="nav__logo" href="/">SL</a>
    <button class="nav__toggle" aria-label="Toggle navigation" onclick="toggleNav()">‚ò∞</button>
    <ul id="navmenu" class="nav__menu">
      <li><a href="/">Home</a></li>
      <li><a href="index.html#projects">Projects</a></li>
      <li><a href="mailto:ethanli041012@gmail.com">Contact</a></li>
      <li><a href="https://github.com/Shubo176" target="_blank" rel="noopener">GitHub</a></li>
      <li>
        <button id="theme-toggle" class="theme-toggle" type="button" aria-label="Toggle dark mode" onclick="toggleTheme()">
          <span aria-hidden="true">üåô</span>
          <span class="theme-toggle__label">Dark</span>
        </button>
      </li>
    </ul>
  </nav>
</header>

<main class="container">
  <nav class="breadcrumb"><a href="index.html#projects">Projects</a> / Protein Tm Prediction</nav>
  <h1>Protein Melting Temperature Prediction via ESM and SaProt</h1>
  <p class="muted">Proteins ¬∑ Multimodal ¬∑ Regression</p>

  <section class="figure">
    <h2>Workflow</h2>
    <img src="assets/img/image2.png" alt="Protein Tm project workflow">
    <figcaption>Dataset construction, embedding fusion, auxiliary head, and evaluation.</figcaption>
    <img src="assets/img/image4.png" alt="Protein Tm project workflow">
    <figcaption>OGTclassify Model Structure.</figcaption>
  </section>

<section>
  <h2>Model Summary</h2>
  <p>
    Under the supervision of <strong>Professor Huifeng Jiang</strong> at the <strong>Tianjin Institute of Industrial Biotechnology, Chinese Academy of Sciences</strong>, I built a Tm prediction model that integrates sequence, structure, and a small set of well-motivated handcrafted features.
  </p>
  <p>
    I curated Tm records primarily from the <strong>Meltome Atlas</strong>, incorporated entries used by prior models such as <strong>DeepStabp</strong> for training, and mined additional records from recent literature. To assess true generalization, entries <strong>published after 2023</strong> formed an <strong>external test set of 74 proteins</strong>, deduplicated against development data by sequence identity and metadata. After <strong>CD-HIT at 90%</strong> identity, I obtained <strong>28,463</strong> pre-2023 entries: <strong>25,617</strong> for training and <strong>2,846</strong> for validation.
  </p>
  <p>
    For representations, I fused <strong>SaProt (650M)</strong> structure embeddings with sequence embeddings from <strong>ESM-2 (650M)</strong>. I standardized handcrafted inputs (<strong>Rosetta ŒîG</strong>, <strong>Shannon entropy</strong>, and an <strong>OGT prior</strong>) and concatenated them before a regression head. Most structures were downloaded from the <strong>AlphaFold Database</strong>; a small portion missing in the database was predicted locally.
  </p>
  <p>
    The regression head is a three-layer MLP with dropout. <strong>Hyperparameters were tuned with Optuna</strong> to balance bias and variance and avoid overfitting to any single subset. For stability estimation, I ran <strong>10-fold cross-validation on the development data with 10 repeats</strong> (100 runs). Across these runs, the mean training RMSE was <strong>5.54</strong> and the validation RMSE was <strong>5.82</strong>.
  </p>
</section>

  <section id="results" class="results">
    <h2>Results</h2>
    <p class="muted">Click headers to sort</p>
    <div class="table-wrap" style="overflow-x:auto">
      <table id="tm-table" style="width:100%; border-collapse: collapse">
        <thead>
          <tr>
            <th data-sort-type="string" style="text-align:left; border-bottom:1px solid var(--border, #ddd); padding:8px; cursor:pointer">Model</th>
            <th data-sort-type="percent" style="text-align:left; border-bottom:1px solid var(--border, #ddd); padding:8px; cursor:pointer">Proteome Coverage</th>
            <th data-sort-type="number" style="text-align:left; border-bottom:1px solid var(--border, #ddd); padding:8px; cursor:pointer">Test RMSE</th>
            <th data-sort-type="number" style="text-align:left; border-bottom:1px solid var(--border, #ddd); padding:8px; cursor:pointer">Validation RMSE</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td style="padding:8px; border-bottom:1px solid var(--border, #eee)">model</td>
            <td style="padding:8px; border-bottom:1px solid var(--border, #eee)">34.18% (893/2613)</td>
            <td style="padding:8px; border-bottom:1px solid var(--border, #eee)">9.3745</td>
            <td style="padding:8px; border-bottom:1px solid var(--border, #eee)">5.8378</td>
          </tr>
          <tr>
            <td style="padding:8px; border-bottom:1px solid var(--border, #eee)">esmtemp</td>
            <td style="padding:8px; border-bottom:1px solid var(--border, #eee)">24.25% (634/2614)</td>
            <td style="padding:8px; border-bottom:1px solid var(--border, #eee)">15.0774</td>
            <td style="padding:8px; border-bottom:1px solid var(--border, #eee)">5.9494</td>
          </tr>
          <tr>
            <td style="padding:8px; border-bottom:1px solid var(--border, #eee)">prostabp2</td>
            <td style="padding:8px; border-bottom:1px solid var(--border, #eee)">22.38% (585/2614)</td>
            <td style="padding:8px; border-bottom:1px solid var(--border, #eee)">17.2452</td>
            <td style="padding:8px; border-bottom:1px solid var(--border, #eee)">8.8761</td>
          </tr>
          <tr>
            <td style="padding:8px; border-bottom:1px solid var(--border, #eee)">seq2Topt</td>
            <td style="padding:8px; border-bottom:1px solid var(--border, #eee)">32.75% (856/2614)</td>
            <td style="padding:8px; border-bottom:1px solid var(--border, #eee)">12.8500</td>
            <td style="padding:8px; border-bottom:1px solid var(--border, #eee)">9.6034</td>
          </tr>
          <tr>
            <td style="padding:8px; border-bottom:1px solid var(--border, #eee)">DeepStabP</td>
            <td style="padding:8px; border-bottom:1px solid var(--border, #eee)">19.28% (504/2614)</td>
            <td style="padding:8px; border-bottom:1px solid var(--border, #eee)">15.6519</td>
            <td style="padding:8px; border-bottom:1px solid var(--border, #eee)">6.4214</td>
          </tr>
          <tr>
            <td style="padding:8px; border-bottom:1px solid var(--border, #eee)">temBERTure</td>
            <td style="padding:8px; border-bottom:1px solid var(--border, #eee)">20.31% (531/2614)</td>
            <td style="padding:8px; border-bottom:1px solid var(--border, #eee)">14.6336</td>
            <td style="padding:8px; border-bottom:1px solid var(--border, #eee)">6.2694</td>
          </tr>
        </tbody>
      </table>
    </div>

    <script>
      (function(){
        const table = document.getElementById('tm-table');
        const filter = document.getElementById('tm-filter');
        const getNumber = (text, type) => {
          if (type === 'percent') {
            const m = String(text).match(/([\d.]+)%/);
            return m ? parseFloat(m[1]) : Number.NaN;
          }
          return parseFloat(text);
        };
        // Sorting
        table.querySelectorAll('th').forEach((th, idx) => {
          let asc = true;
          th.addEventListener('click', () => {
            const type = th.getAttribute('data-sort-type') || 'string';
            const rows = Array.from(table.tBodies[0].rows);
            rows.sort((a, b) => {
              let av = a.cells[idx].innerText.trim();
              let bv = b.cells[idx].innerText.trim();
              if (type === 'number' || type === 'percent') {
                av = getNumber(av, type);
                bv = getNumber(bv, type);
                return asc ? av - bv : bv - av;
              }
              return asc ? av.localeCompare(bv) : bv.localeCompare(av);
            });
            rows.forEach(r => table.tBodies[0].appendChild(r));
            asc = !asc;
          });
        });
        // Filtering
        filter.addEventListener('input', () => {
          const q = filter.value.toLowerCase();
          Array.from(table.tBodies[0].rows).forEach(row => {
            const show = row.innerText.toLowerCase().includes(q);
            row.style.display = show ? '' : 'none';
          });
        });
      })();
    </script>
  </section>

  <p><a class="btn btn--ghost" href="index.html#projects">‚Üê Back to Projects</a></p>
</main>

<footer class="site-footer">
  <small>¬© <span id="year"></span> Shubo Li</small>
</footer>
</body>
</html>
