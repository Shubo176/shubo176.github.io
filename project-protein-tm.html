<!doctype html>
<html lang="en" data-theme="light">
<head>
  <meta charset="utf-8">
  <title>Protein Tm Prediction ‚Äî Shubo Li</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Protein melting temperature prediction via ESM and AlphaFold with biophysical features">
  <link rel="stylesheet" href="assets/style.css">
  <script defer src="assets/site.js"></script>
</head>
<body>
<header class="site-header">
  <nav class="nav">
    <a class="nav__logo" href="/">SL</a>
    <button class="nav__toggle" aria-label="Toggle navigation" onclick="toggleNav()">‚ò∞</button>
    <ul id="navmenu" class="nav__menu">
      <li><a href="/">Home</a></li>
      <li><a href="index.html#projects">Projects</a></li>
      <li><a href="mailto:ethanli041012@gmail.com">Contact</a></li>
      <li><a href="https://github.com/Shubo176" target="_blank" rel="noopener">GitHub</a></li>
      <li>
        <button id="theme-toggle" class="theme-toggle" type="button" aria-label="Toggle dark mode" onclick="toggleTheme()">
          <span aria-hidden="true">üåô</span>
          <span class="theme-toggle__label">Dark</span>
        </button>
      </li>
    </ul>
  </nav>
</header>

<main class="container">
  <nav class="breadcrumb"><a href="index.html#projects">Projects</a> / Protein Tm Prediction</nav>
  <h1>Protein Melting Temperature Prediction via ESM and AlphaFold</h1>
  <p class="muted">Proteins ¬∑ Multimodal ¬∑ Regression</p>

  <section class="figure">
    <h2>Workflow</h2>
    <img src="assets/img/image2.png" alt="Protein Tm project workflow">
    <figcaption>Dataset construction, embedding fusion, auxiliary head, and evaluation.</figcaption>
    <img src="assets/img/image4.png" alt="Protein Tm project workflow">
    <figcaption>OGTclassify Model Structure.</figcaption>
  </section>

  <section>
    <h2>Model Summary</h2>
    <p>
      I owned the modeling and algorithmic components of this melting-temperature project. Working with our collaborators‚Äô curated dataset (FireProt, ProThermDB, Meltome, ThermoMutDB, and more recent literature extractions), I handled quality control after the CD-HIT deduplication stage, ensuring the 28,463 proteins we retained had consistent structural metadata and thermodynamic annotations. The dataset was stratified into a 90/10 train‚Äìvalidation split plus a 2023+ temporal holdout of 75 proteins used only for final generalization checks.</p>
    <p>
      My primary responsibility was to design the multimodal fusion model. I benchmarked multiple representation strategies and settled on pairing AlphaFold-derived SaProt structural embeddings (via precomputed distograms and pLDDT summaries projected to 1280 dimensions) with ESM sequence embeddings of the same width. I engineered additional handcrafted features‚Äîincluding Rosetta ŒîG estimates, Shannon entropy, oligomeric state, and an OGT prior‚Äîthen standardized and concatenated them into a single feature vector.</p>
    <p>
      The regression head I implemented is a three-layer MLP (Linear‚ÜíReLU‚ÜíDropout) that reduces the fused feature dimension to half-width before emitting a single Tm prediction. I experimented with residual MLP variants and attention pooling, documenting the trade-offs; the chosen architecture hit the best bias‚Äìvariance balance while staying GPU-efficient for large batches. To keep the model honest about uncertainty, I added MC dropout at inference time, which we now surface as confidence intervals when reporting predictions.</p>
    <p>
      Training infrastructure was another core deliverable. I wrapped the entire pipeline in Optuna for automated hyperparameter tuning (learning rate, hidden width H, dropout, weight decay, batch size), integrated mixed-precision training, and built a metric dashboard tracking RMSE, MAE, and Pearson correlation per fold. After tuning, we reached an RMSE of 9.37 on the temporal test set‚Äîbeating prior baselines we reimplemented, and the model's stability was verified by 10 repeats of 10-fold cross-validation (100 total fits).</p>
  </section>

  <section id="results" class="results">
    <h2>Results</h2>
    <p class="muted">Click headers to sort</p>
    <div class="table-wrap" style="overflow-x:auto">
      <table id="tm-table" style="width:100%; border-collapse: collapse">
        <thead>
          <tr>
            <th data-sort-type="string" style="text-align:left; border-bottom:1px solid var(--border, #ddd); padding:8px; cursor:pointer">Model</th>
            <th data-sort-type="percent" style="text-align:left; border-bottom:1px solid var(--border, #ddd); padding:8px; cursor:pointer">Proteome Coverage</th>
            <th data-sort-type="number" style="text-align:left; border-bottom:1px solid var(--border, #ddd); padding:8px; cursor:pointer">Test RMSE</th>
            <th data-sort-type="number" style="text-align:left; border-bottom:1px solid var(--border, #ddd); padding:8px; cursor:pointer">Validation RMSE</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td style="padding:8px; border-bottom:1px solid var(--border, #eee)">model</td>
            <td style="padding:8px; border-bottom:1px solid var(--border, #eee)">34.18% (893/2613)</td>
            <td style="padding:8px; border-bottom:1px solid var(--border, #eee)">9.3745</td>
            <td style="padding:8px; border-bottom:1px solid var(--border, #eee)">5.8378</td>
          </tr>
          <tr>
            <td style="padding:8px; border-bottom:1px solid var(--border, #eee)">esmtemp</td>
            <td style="padding:8px; border-bottom:1px solid var(--border, #eee)">24.25% (634/2614)</td>
            <td style="padding:8px; border-bottom:1px solid var(--border, #eee)">15.0774</td>
            <td style="padding:8px; border-bottom:1px solid var(--border, #eee)">5.9494</td>
          </tr>
          <tr>
            <td style="padding:8px; border-bottom:1px solid var(--border, #eee)">prostabp2</td>
            <td style="padding:8px; border-bottom:1px solid var(--border, #eee)">22.38% (585/2614)</td>
            <td style="padding:8px; border-bottom:1px solid var(--border, #eee)">17.2452</td>
            <td style="padding:8px; border-bottom:1px solid var(--border, #eee)">8.8761</td>
          </tr>
          <tr>
            <td style="padding:8px; border-bottom:1px solid var(--border, #eee)">seq2Topt</td>
            <td style="padding:8px; border-bottom:1px solid var(--border, #eee)">32.75% (856/2614)</td>
            <td style="padding:8px; border-bottom:1px solid var(--border, #eee)">12.8500</td>
            <td style="padding:8px; border-bottom:1px solid var(--border, #eee)">9.6034</td>
          </tr>
          <tr>
            <td style="padding:8px; border-bottom:1px solid var(--border, #eee)">DeepStabP</td>
            <td style="padding:8px; border-bottom:1px solid var(--border, #eee)">19.28% (504/2614)</td>
            <td style="padding:8px; border-bottom:1px solid var(--border, #eee)">15.6519</td>
            <td style="padding:8px; border-bottom:1px solid var(--border, #eee)">6.4214</td>
          </tr>
          <tr>
            <td style="padding:8px; border-bottom:1px solid var(--border, #eee)">temBERTure</td>
            <td style="padding:8px; border-bottom:1px solid var(--border, #eee)">20.31% (531/2614)</td>
            <td style="padding:8px; border-bottom:1px solid var(--border, #eee)">14.6336</td>
            <td style="padding:8px; border-bottom:1px solid var(--border, #eee)">6.2694</td>
          </tr>
        </tbody>
      </table>
    </div>

    <script>
      (function(){
        const table = document.getElementById('tm-table');
        const filter = document.getElementById('tm-filter');
        const getNumber = (text, type) => {
          if (type === 'percent') {
            const m = String(text).match(/([\d.]+)%/);
            return m ? parseFloat(m[1]) : Number.NaN;
          }
          return parseFloat(text);
        };
        // Sorting
        table.querySelectorAll('th').forEach((th, idx) => {
          let asc = true;
          th.addEventListener('click', () => {
            const type = th.getAttribute('data-sort-type') || 'string';
            const rows = Array.from(table.tBodies[0].rows);
            rows.sort((a, b) => {
              let av = a.cells[idx].innerText.trim();
              let bv = b.cells[idx].innerText.trim();
              if (type === 'number' || type === 'percent') {
                av = getNumber(av, type);
                bv = getNumber(bv, type);
                return asc ? av - bv : bv - av;
              }
              return asc ? av.localeCompare(bv) : bv.localeCompare(av);
            });
            rows.forEach(r => table.tBodies[0].appendChild(r));
            asc = !asc;
          });
        });
        // Filtering
        filter.addEventListener('input', () => {
          const q = filter.value.toLowerCase();
          Array.from(table.tBodies[0].rows).forEach(row => {
            const show = row.innerText.toLowerCase().includes(q);
            row.style.display = show ? '' : 'none';
          });
        });
      })();
    </script>
  </section>

  <p><a class="btn btn--ghost" href="index.html#projects">‚Üê Back to Projects</a></p>
</main>

<footer class="site-footer">
  <small>¬© <span id="year"></span> Shubo Li</small>
</footer>
</body>
</html>
