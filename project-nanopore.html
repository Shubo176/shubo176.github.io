<!doctype html>
<html lang="en" data-theme="light">
<head>
  <meta charset="utf-8">
  <title>DNA Modification Detection ‚Äî Shubo Li</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Nanopore-based DNA modification detection with a Transformer model">
  <link rel="stylesheet" href="assets/style.css">
  <script defer src="assets/site.js"></script>
</head>
<body>
<header class="site-header">
  <nav class="nav">
    <a class="nav__logo" href="/">SL</a>
    <button class="nav__toggle" aria-label="Toggle navigation" onclick="toggleNav()">‚ò∞</button>
    <ul id="navmenu" class="nav__menu">
      <li><a href="/">Home</a></li>
      <li><a href="index.html#projects">Projects</a></li>
      <li><a href="mailto:ethanli041012@gmail.com">Contact</a></li>
      <li><a href="https://github.com/Shubo176" target="_blank" rel="noopener">GitHub</a></li>
      <li>
        <button id="theme-toggle" class="theme-toggle" type="button" aria-label="Toggle dark mode" onclick="toggleTheme()">
          <span aria-hidden="true">üåô</span>
          <span class="theme-toggle__label">Dark</span>
        </button>
      </li>
    </ul>
  </nav>
</header>

<main class="container">
  <nav class="breadcrumb"><a href="index.html#projects">Projects</a> / DNA Modification Detection</nav>
  <h1>DNA Modification Detection from Nanopore Signals with Transformers</h1>
  <p class="muted">Genomics ¬∑ Multimodal ¬∑ Transformer</p>

  <section class="figure">
    <h2>Pipeline</h2>
    <img src="assets/img/image1.png" alt="Nanopore project pipeline">
    <img src="assets/img/image3.png" alt="Nanopore project pipeline">
    <figcaption>End-to-end pipeline from raw current to classification.</figcaption>
  </section>

  <section>
  <h2>Model Summary</h2>
    <p>
      I led the full ML portion of this project, designing both the data extraction workflow and the neural network that performs modification detection on nanopore signals. The wet-lab team sequenced three <em>Salmonella</em> cohorts (xtg103 unmodified, engineered plasmid fully modified, sal87 partially modified). From the raw fast5 outputs, I aligned reads to the reference genome, carved 21 bp windows centered on candidate sites, and synchronized the ionic current traces so each event aligned with its nucleotide window. Outlier bursts were clipped, sequences were normalized per-read, and missing stretches were imputed before packaging everything into training-ready tensors.</p>
    <p>
      The resulting feature for each locus combined one-hot DNA bases with 32-point current segments, producing a 21√ó36 matrix. XtG103 and the plasmid runs served as clean supervision signals, while sal87 was held out for evaluation.</p>
    <p>
      The classifier is a Transformer encoder tailored for short genomic contexts: a linear projection with sinusoidal positional encodings, six encoder blocks (8 heads, d<sub>model</sub>=512, FFN=256, GELU), residual connections and LayerNorm as in the standard encoder stack, and dropout=0.2. Mean pooling feeds a two-layer MLP that outputs <b>two-class logits</b>; probabilities are obtained via <b>softmax</b> and trained with <b>CrossEntropyLoss</b>. Optimization uses <b>AdamW</b> (lr=1e-4, weight decay=1e-4) with <b>ReduceLROnPlateau</b> on validation F1 and early stopping (patience=8). We track loss, accuracy, precision, recall, F1, and AUC per epoch.</p>
    <p>
      On the held-out sal87 set the model recovered a 20% modification rate, matching external assays. These choices formed a deployable pipeline that turns nanopore currents into reliable modification calls.</p>
  </section>


  <p><a class="btn btn--ghost" href="index.html#projects">‚Üê Back to Projects</a></p>
</main>

<footer class="site-footer">
  <small>¬© <span id="year"></span> Shubo Li</small>
</footer>
</body>
</html>
