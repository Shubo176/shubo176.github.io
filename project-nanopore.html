<!doctype html>
<html lang="en" data-theme="light">
<head>
  <meta charset="utf-8">
  <title>DNA Modification Detection ‚Äî Shubo Li</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Nanopore-based DNA modification detection with a Transformer model">
  <link rel="stylesheet" href="assets/style.css">
  <script defer src="assets/site.js"></script>
</head>
<body>
<header class="site-header">
  <nav class="nav">
    <a class="nav__logo" href="/">SL</a>
    <button class="nav__toggle" aria-label="Toggle navigation" onclick="toggleNav()">‚ò∞</button>
    <ul id="navmenu" class="nav__menu">
      <li><a href="/">Home</a></li>
      <li><a href="projects.html">Projects</a></li>
      <li><a href="mailto:ethanli041012@gmail.com">Contact</a></li>
      <li><a href="https://github.com/Shubo176" target="_blank" rel="noopener">GitHub</a></li>
      <li>
        <button id="theme-toggle" class="theme-toggle" type="button" aria-label="Toggle dark mode" onclick="toggleTheme()">
          <span aria-hidden="true">üåô</span>
          <span class="theme-toggle__label">Dark</span>
        </button>
      </li>
    </ul>
  </nav>
</header>

<main class="container">
  <nav class="breadcrumb"><a href="projects.html">Projects</a> / DNA Modification Detection</nav>
  <h1>DNA Modification Detection from Nanopore Signals with Transformers</h1>
  <p class="muted">Genomics ¬∑ Multimodal ¬∑ Transformer</p>

  <section class="figure">
    <h2>Pipeline</h2>
    <img src="assets/img/image1.png" alt="Nanopore project pipeline">
    <img src="assets/img/image3.png" alt="Nanopore project pipeline">
    <figcaption>End-to-end pipeline from raw current to classification.</figcaption>
  </section>

  <section>
    <h2>Model Summary</h2>
    <p>
    This project aims to build a deep learning‚Äìbased DNA modification detection system using nanopore sequencing signals, forming a complete data analysis pipeline from biological sequencing to AI model training.</p> <p>First, during the experimental phase, different <em>Salmonella</em> strains were selected: <strong>xtg103</strong> as an unmodified sample and <strong>sal87</strong> containing both modified and unmodified sites. Researchers engineered a plasmid to introduce modifications at specific sites, creating a fully modified sample. These strains were sequenced using a <strong>Nanopore sequencer</strong> to obtain high-resolution electrical signal data, which were then subjected to preprocessing.</p> <p>During <strong>data preprocessing</strong>, sequencing reads were aligned to a reference genome, and a 21-base window around the target sequence was extracted along with the corresponding electrical signals. Each fragment recorded a signal intensity sequence, e.g. [118, 123, 121, ‚Ä¶]. After normalization, the values were scaled to a range such as [-1.23, -0.82, -0.99, ‚Ä¶]. To ensure uniform input, signals longer than 32 were truncated, while shorter ones were padded. The DNA sequences were <strong>one-hot encoded</strong> (A, T, C, G mapped to numeric matrices) and concatenated with normalized signal data to form a <strong>21√ó36 feature matrix</strong>, consisting of 4 dimensions from nucleotide encoding and 32 from signal features.</p> <p>This matrix was input into a <strong>Transformer-based neural network</strong>. The model was trained and validated using the completely unmodified xtg103 and fully modified plasmid data, while sal87 served as the test set. Model performance was assessed by comparing the predicted modification ratio on sal87.</p> <p>The model projected the input into a high-dimensional feature space via a linear projection layer and added <strong>positional encoding</strong> to preserve sequence order. The backbone comprised <strong>six stacked encoder layers</strong>, each with <strong>multi-head attention</strong> (8 heads, 64 dimensions each) and a feedforward network (512‚Üí256‚Üí512) using <strong>GELU</strong> activation. <strong>Dropout, residual connections,</strong> and <strong>layer normalization</strong> were applied between layers to improve stability and generalization. After six layers of feature extraction, outputs were aggregated via <strong>mean pooling</strong>, followed by a <strong>multilayer perceptron classifier</strong>, producing a binary classification through a <strong>logistic function</strong> to distinguish modified vs. unmodified states.</p> <p>During training (1‚Äì20 epochs), the process alternated between training and validation phases. A scheduler dynamically adjusted the learning rate based on <strong>F1-score</strong> improvements. When model performance improved, the system saved the best weights as <strong>best.pth</strong>; otherwise, it increased a patience counter. If no improvement occurred after several validations or the maximum epoch count was reached, <strong>early stopping</strong> was triggered, saving the final weights as <strong>last.pth</strong>.</p> <p>This pipeline forms a closed-loop system‚Äîfrom sample preparation and signal normalization to feature construction and Transformer-based classification‚Äîachieving automated DNA modification detection from nanopore signals. The model predicted <strong>20% modification on sal87</strong>, consistent with published literature.
    </p>
  </section>

  <p><a class="btn btn--ghost" href="projects.html">‚Üê Back to Projects</a></p>
</main>

<footer class="site-footer">
  <small>¬© <span id="year"></span> Shubo Li</small>
</footer>
</body>
</html>
